import numpy as npimport pandas as pdimport matplotlib.pyplot as pltimport xarray as xrimport cartopy.crs as ccrs#%% Cell 1: Import climate dataimport os#%% Cell 1: Load the data# fig, ax = plt.subplots(figsize=(20, 10), subplot_kw={'projection': ccrs.PlateCarree()})models=["IPSL-CM6","E3SM","CESM2", "CNRM"] members=[0,3,6,4]mode_suff='total'#load the baseline data derived from OGGM uni-bremen serverw5e5_path = '/Users/magaliponds/Library/CloudStorage/OneDrive-VrijeUniversiteitBrussel/1. VUB/02. Coding/01. IRRMIP/03. Data/01. Input files/01. Climate data/W5E5/cluster.klima.uni-bremen.de/~oggm/climate/gswp3-w5e5/flattened/2023.2/monthly'pr_path=f'{w5e5_path}/gswp3-w5e5_obsclim_pr_global_monthly_1901_2019_flat_glaciers.nc'tas_path=f'{w5e5_path}/gswp3-w5e5_obsclim_tas_global_monthly_1901_2019_flat_glaciers.nc'# The baseline contains two seperate files for tas en prbaseline_pr = xr.open_dataset(pr_path)baseline_tas = xr.open_dataset(tas_path)members=[1,3,4,6]for (m,model) in enumerate(["IPSL-CM6","E3SM","CESM2", "CNRM"]):     for member in range(members[m]):        for plotvar in ["DIF"]: #alternatively also for IRR, NOI, not of interest at the moment                for timeframe in ["annual","seasonal","monthly"]:                    for mode in ['dif']: #alternatively also for std, not of interest at the moment                        print(plotvar, model, member, )                                              # regrid_climate_data(plotvar, model, member, var, timeframe, mode, dif)                        diff_folder_pr=f"/Users/magaliponds/OneDrive - Vrije Universiteit Brussel/1. VUB/02. Coding/01. IRRMIP/03. Data/03. Output files/01. Climate data/03. Regridded Perturbations/Precipitation/{timeframe}/{model}/{member}"                         diff_folder_tas=f"/Users/magaliponds/OneDrive - Vrije Universiteit Brussel/1. VUB/02. Coding/01. IRRMIP/03. Data/03. Output files/01. Climate data/03. Regridded Perturbations/Temperature/{timeframe}/{model}/{member}"                         #create a new directory if it doesnt exist yet                        pr_perturbation_path=f"{diff_folder_pr}/REGRID.{model}.PR.{plotvar}.00{member}.1985_2014_selparam_{timeframe}_total_rel.nc"                        tas_perturbation_path=f"{diff_folder_tas}/REGRID.{model}.TEMP.{plotvar}.00{member}.1985_2014_selparam_{timeframe}_total_abs.nc"                                                 #first for each variable load the data, for precipitation this consists of Snow & Rain from atmosphere, converted from [mm/day]                        pr_perturbation=xr.open_dataset(pr_perturbation_path)                        tas_perturbation=xr.open_dataset(tas_perturbation_path)                        #Due to irrigation temperature decreases, so without irrigation it would be warmer. Baseline is the scenario with irrigation, so we have to subtract the perturbation found                        perturbed_baseline_pr = baseline_pr*(1-pr_perturbation)                        perturbed_baseline_tas = baseline_tas*-tas_perturbation                         o_folder_pr=f"/Users/magaliponds/OneDrive - Vrije Universiteit Brussel/1. VUB/02. Coding/01. IRRMIP/03. Data/03. Output files/01. Climate data/04. Perturbed Baseline/Precipitation/{timeframe}/{model}/{member}"                         o_folder_tas=f"/Users/magaliponds/OneDrive - Vrije Universiteit Brussel/1. VUB/02. Coding/01. IRRMIP/03. Data/03. Output files/01. Climate data/04. Perturbed Baseline/Temperature/{timeframe}/{model}/{member}"                                         pr_data_out=f"{o_folder_pr}/REGRID.perturbed.baseline.{model}.PR.{plotvar}.00{member}.1985_2014_selparam_{timeframe}_total_rel.nc"                        tas_data_out=f"{o_folder_tas}/REGRID.perturbed.baseline.{model}.TEMP.{plotvar}.00{member}.1985_2014_selparam_{timeframe}_total_abs.nc"                        os.makedirs(o_folder_pr, exist_ok=True)                        os.makedirs(o_folder_tas, exist_ok=True)                                                print("saving file to:", pr_data_out)                        perturbed_baseline_pr.to_netcdf(pr_data_out)                        perturbed_baseline_tas.to_netcdf(tas_data_out)                            